/*! For license information please see ffefc661.0dd0c914.js.LICENSE.txt */
"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([[284866],{56959:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>l});var n=r(474848),a=r(28453);const o={id:"experimental",title:"Experimental Features",description:"Information on Experimental Features that are currently available in the Scaffolder"},s=void 0,i={id:"features/software-templates/experimental",title:"Experimental Features",description:"Information on Experimental Features that are currently available in the Scaffolder",source:"@site/../docs/features/software-templates/experimental.md",sourceDirName:"features/software-templates",slug:"/features/software-templates/experimental",permalink:"/docs/next/features/software-templates/experimental",draft:!1,unlisted:!1,editUrl:"https://github.com/backstage/backstage/edit/master/docs/features/software-templates/experimental.md",tags:[],version:"current",frontMatter:{id:"experimental",title:"Experimental Features",description:"Information on Experimental Features that are currently available in the Scaffolder"},sidebar:"docs",previous:{title:"Dry Run Testing",permalink:"/docs/next/features/software-templates/dry-run-testing"},next:{title:"Overview",permalink:"/docs/next/features/techdocs/"}},c={},l=[{value:"Introduction",id:"introduction",level:2},{value:"Retries and Recovery",id:"retries-and-recovery",level:2},{value:"TODO",id:"todo",level:3},{value:"Form Decorators",id:"form-decorators",level:2},{value:"Installation",id:"installation",level:4},{value:"Creating a Decorator",id:"creating-a-decorator",level:4}];function d(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"introduction",children:"Introduction"}),"\n",(0,n.jsx)(t.p,{children:"This section contains information and guides on the experimental features that are currently available in the Scaffolder. Be advised that these features are still in development and may not be fully stable or complete, and are subject to change at any time."}),"\n",(0,n.jsxs)(t.p,{children:["Please leave feedback on these features in the ",(0,n.jsx)(t.a,{href:"https://discord.com/invite/MUpMjP2",children:"Backstage Discord"})," or by ",(0,n.jsx)(t.a,{href:"https://github.com/backstage/backstage/issues/new/choose",children:"creating an issue"})," on the Backstage GitHub repository."]}),"\n",(0,n.jsx)(t.h2,{id:"retries-and-recovery",children:"Retries and Recovery"}),"\n",(0,n.jsx)(t.h3,{id:"todo",children:"TODO"}),"\n",(0,n.jsx)(t.h2,{id:"form-decorators",children:"Form Decorators"}),"\n",(0,n.jsxs)(t.p,{children:["Form decorators provide the ability to run arbitrary code before the form is submitted along with secrets to the ",(0,n.jsx)(t.code,{children:"scaffolder-backend"})," plugin. They are provided to the ",(0,n.jsx)(t.code,{children:"app"})," using a Utility API."]}),"\n",(0,n.jsx)(t.h4,{id:"installation",children:"Installation"}),"\n",(0,n.jsxs)(t.p,{children:["To install the Form Decorators, add the following to your ",(0,n.jsx)(t.code,{children:"packages/app/src/apis.ts"}),":"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",children:"  createApiFactory({\n    api: formDecoratorsApiRef,\n    deps: {},\n    factory: () =>\n      DefaultScaffolderFormDecoratorsApi.create({\n        decorators: [\n          // add decorators here\n        ],\n      }),\n  }),\n"})}),"\n",(0,n.jsxs)(t.p,{children:["And then you'll also need to define which decorators run in each template using the ",(0,n.jsx)(t.code,{children:"EXPERIMENTAL_formDecorators"})," key in the template's ",(0,n.jsx)(t.code,{children:"spec"}),":"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-yaml",children:"kind: Template\nmetadata:\n  name: my-template\nspec:\n  EXPERIMENTAL_formDecorators:\n    - id: my-decorator\n      input:\n        test: something funky\n\n  parameters: ...\n  steps: ...\n"})}),"\n",(0,n.jsx)(t.h4,{id:"creating-a-decorator",children:"Creating a Decorator"}),"\n",(0,n.jsxs)(t.p,{children:["You can create a decorator using the simple helper method ",(0,n.jsx)(t.code,{children:"createScaffolderFormDecorator"}),":"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",children:"export const mockDecorator = createScaffolderFormDecorator({\n  // give the decorator a name\n  id: 'mock-decorator',\n\n  // define the schema for the input that can be proided in `template.yaml`\n  schema: {\n    input: {\n      test: z => z.string(),\n    },\n  },\n  deps: {\n    // define dependencies here\n    githubApi: githubAuthApiRef,\n  },\n  decorator: async (\n    // Context has all the things needed to write simple decorators\n    { setSecrets, setFormState, input: { test } },\n    // Depepdencies injected here\n    { githubApi },\n  ) => {\n    // mutate the form state\n    setFormState(state => ({ ...state, test, mock: 'MOCK' }));\n\n    // mutate the form secrets\n    setSecrets(state => ({ ...state, GITHUB_TOKEN: 'MOCK_TOKEN' }));\n  },\n});\n"})})]})}function p(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},221020:(e,t,r)=>{var n=r(296540),a=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,r){var n,o={},l=null,d=null;for(n in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(d=t.ref),t)s.call(t,n)&&!c.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===o[n]&&(o[n]=t[n]);return{$$typeof:a,type:e,key:l,ref:d,props:o,_owner:i.current}}t.Fragment=o,t.jsx=l,t.jsxs=l},474848:(e,t,r)=>{e.exports=r(221020)},28453:(e,t,r)=>{r.d(t,{R:()=>s,x:()=>i});var n=r(296540);const a={},o=n.createContext(a);function s(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);