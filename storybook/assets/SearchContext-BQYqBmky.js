import{l as T}from"./lodash-CoGan1YB.js";import{r,R as l}from"./index-CTjT7uj6.js";import{u as k}from"./useAsync-CXA3qup_.js";import{s as F}from"./api-CKDuuaL7.js";import{b as _,u as A}from"./ApiRef-BSBwTmJJ.js";import{A as j,u as M}from"./useAnalytics-DTrkS1Gy.js";import{a as O,c as V}from"./ConfigApi-DBUUc3nU.js";function b(e){var o=r.useRef();return r.useEffect(function(){o.current=e}),o.current}const x=_("search-context"),Z=()=>{const e=r.useContext(x);if(!e)throw new Error("useSearch must be used within a SearchContextProvider");const o=e.atVersion(1);if(!o)throw new Error("No SearchContext v1 found");return o},z=()=>r.useContext(x)!==void 0,w={term:"",types:[],filters:{},pageLimit:void 0,pageCursor:void 0},B=(e=w)=>{var C,S,P,y;const o=A(F),u=M(),[t,p]=r.useState(e.term),[i,h]=r.useState(e.types),[a,v]=r.useState(e.filters),[f,L]=r.useState(e.pageLimit),[m,n]=r.useState(e.pageCursor),g=b(t),d=b(a),s=k(async()=>{var E;const c=await o.query({term:t,types:i,filters:a,pageLimit:f,pageCursor:m});return t&&u.captureEvent("search",t,{value:((E=s.value)==null?void 0:E.numberOfResults)??void 0}),c},[t,i,a,f,m]),I=!s.loading&&!s.error&&((C=s.value)==null?void 0:C.nextPageCursor),N=!s.loading&&!s.error&&((S=s.value)==null?void 0:S.previousPageCursor),R=r.useCallback(()=>{var c;n((c=s.value)==null?void 0:c.nextPageCursor)},[(P=s.value)==null?void 0:P.nextPageCursor]),q=r.useCallback(()=>{var c;n((c=s.value)==null?void 0:c.previousPageCursor)},[(y=s.value)==null?void 0:y.previousPageCursor]);return r.useEffect(()=>{g!==void 0&&t!==g&&n(void 0)},[t,g,n]),r.useEffect(()=>{d!==void 0&&!T.isEqual(a,d)&&n(void 0)},[a,d,n]),{result:s,term:t,setTerm:p,types:i,setTypes:h,filters:a,setFilters:v,pageLimit:f,setPageLimit:L,pageCursor:m,setPageCursor:n,fetchNextPage:I?R:void 0,fetchPreviousPage:N?q:void 0}},D=e=>{const{initialState:o,children:u}=e,t=B(o);return l.createElement(j,{attributes:{searchTypes:t.types.sort().join(",")}},l.createElement(x.Provider,{value:O({1:t})},u))},G=e=>{const{initialState:o,inheritParentContextIfAvailable:u,children:t}=e,p=z(),i=A(V),h=o??{},a=i.has("search.query.pageLimit")?{pageLimit:i.getNumber("search.query.pageLimit")}:{},v={...w,...h,...a};return p&&u?l.createElement(l.Fragment,null,t):l.createElement(D,{initialState:v},t)};G.__docgenInfo={description:`@public
Search context provider which gives you access to shared state between search components`,methods:[],displayName:"SearchContextProvider"};export{G as S,b as a,Z as u};
